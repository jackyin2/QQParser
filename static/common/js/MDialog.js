/**
 * M.Dialog 2.2.0
 * Date: 2014-07-10
 * Update: 2014-11-30
 * (c) 2014-2014 M.J, http://webjyh.com
 *
 * This is licensed under the GNU LGPL, version 2.1 or later.
 * For details, see: http://creativecommons.org/licenses/LGPL/2.1/
 */
!function(a){var b=a,c=b.document,d=function(a){return new d.fn.init(a)};d.version="2.2.0",d.fn=d.prototype={init:function(a){var e,f;return this.IE6=!-[1]&&!b.XMLHttpRequest,this.closeBoolean=!1,this.iframeId=null,this.top=null,this.config=this._cover(a,d.defaults),b.MDialog.zIndex=b.MDialog.zIndex>=this.config.zIndex?b.MDialog.zIndex:this.config.zIndex,this.config.id&&(f=c.getElementById(this.config.id))?!1:(this.DOM=e=this._createDOM(),e._body()._css({width:this.config.width,height:this.config.height}),e._content()._padding(this.config.padding),e._footer()._hide(),e._title()._css("cursor",this.config.drag?"move":"auto"),this.config.lock&&this._createLock(),e._wrap()._show(),this._title(this.config.title)._content(this.config.content)._statusbar(this.config.statusbar)._button(this.config.button)._position(this.config.top,this.config.left)._addEvent(),"function"==typeof this.config.init&&this.config.init.call(this),void 0)},title:function(a){return this._title(a),this._position(this.config.top,this.config.left,!0),this},untitle:function(a){return this.DOM,this.config.untitle=!0,a&&(this.config.unclose=!0),this._title(this.config.title),this._position(this.config.top,this.config.left,!0),this},content:function(a){return this._content(a),this._position(this.config.top,this.config.left,!0),this},statusbar:function(a){return this._statusbar(a),this._position(this.config.top,this.config.left,!0),this},time:function(a){var b=this;return setTimeout(function(){b._closeEvent(b.config.close)},1e3*a),this},close:function(a){return"function"==typeof a&&(this.config.close=a),this._closeEvent(this.config.close),this},lock:function(){return this.DOM,this.config.lock||(this.config.lock=!0,this._createLock()),this},unlock:function(){var a=this.DOM;return this.config.lock&&(this.config.lock&&c.body.removeChild(a._lock()[0]),this.config.lock=!1),this},width:function(a){return this.config.width=a,this._size("width",a),this},height:function(a){return this.config.height=a,this._size("height",a),this},padding:function(a){var b=this.DOM;return this.config.padding=a,b._content()._padding(a),this._position(this.config.top,this.config.left,!0),this},position:function(a,b){var c,d;return c="number"==typeof a?a+"px":a,d="number"==typeof b?b+"px":b,this.config.top=c,this.config.left=d,this._position(this.config.top,this.config.left,!0),this},button:function(a){return this._isArray(a)&&(this._button(a),this._position(this.config.top,this.config.left,!0)),this},msg:function(a){var b=this.DOM;return this.config.untitle=!0,this.config.unclose=!0,this.config.fixed=!0,this.config.padding="10px 15px",this.config.top="50%",b._content()._addClass("ui-MDialog-msg"),b._content()._padding(this.config.padding),b._footer()._hide(),this._title(this.config.title),this._content(a),this._position(this.config.top,this.config.left,!0),this},_cover:function(a,b){var c,a=a||{};for(c in b)void 0===a[c]&&(a[c]=b[c]);return a},_title:function(a){var b=this.DOM;return b._title()._text(a),this.config.untitle&&(b._title()._hide(),b._close()._addClass("untitle"),this.config.drag=!1),this.config.unclose&&b._close()._hide(),this},_content:function(a){var b=this.DOM;return this.config.iframe?this._createIframe(a):b._content()._html(a),this},_statusbar:function(a){var b=this.DOM;return null!=a&&(b._footer()._show(),b._statusbar()._html(a)),this},_button:function(a){var b=a||[],c=["name","callback","focus","disabled"],d=function(a){var d,b={};for(d=0;d<c.length;d++)b[c[d]]=a[d];return b};return null!=this.config.cancel&&b.unshift(d([this.config.cancelVal,this.config.cancel,!1,!1])),null!=this.config.ok&&b.unshift(d([this.config.okVal,this.config.ok,!0,!1])),this._createButton(b),this},_addEvent:function(){var d=this.DOM,e=this,f=this._sizzle(c),g=this._sizzle(b);return d._close()._bind("click",function(){e._closeEvent(e.config.close)}),this.config.fixed&&this.IE6&&g()._bind("scroll",function(){e._fixedEvent()}),d._wrap()._bind("mousedown",function(){e._focusEvent()}),d._header()._bind("mousedown",function(){d._wrap()._addClass("ui-MDialog-focus")}),d._wrap()._bind("mouseup",function(){d._wrap()._removeClass("ui-MDialog-focus")}),this.config.time&&this.time(this.config.time),this.config.esc&&f()._bind("keydown",function(b){var b=b||a.event,c=b.which||b.keyCode;27==c&&e._closeEvent(e.config.close)}),this.config.resize&&g()._bind("resize",function(){e._resize()}),this.config.drag&&this._drag(),this},_createDOM:function(){var b,e,f,g,a=c.createElement("div");for(a.innerHTML=d.templates,a.className="ui-MDialog-wrap",this.config.id&&a.setAttribute("id",this.config.id),c.body.appendChild(a),b={_wrap:this._sizzle(a)},e=0,f=a.getElementsByTagName("*"),elemLen=f.length;elemLen>e;e++)g=f[e].className.replace("ui-MDialog-",""),g&&(b["_"+g]=this._sizzle(f[e]));return b},_createLock:function(){var a=this.DOM,d=c.createElement("div"),e=c.documentElement.clientHeight,f=c.documentElement.scrollHeight,g=e>f?e+"px":f+"px",h='<iframe style="position:absolute;width:100%;height:100%;_filter:alpha(opacity=0);opacity=0;"></iframe>',i=b.MDialog.zIndex-1;return d.className="ui-MDialog-lock",this.IE6&&(d.innerHTML=h),c.body.appendChild(d),a._lock=this._sizzle(d),a._lock()._css({position:"absolute",top:"0px",left:"0px",width:"100%",height:g,backgroundColor:this.config.background,opacity:this.config.opacity,zIndex:i}),this},_createButton:function(a){for(var g,h,b=this.DOM,d=this,e=0,f=a.length;f>e;e++)g=this._sizzle(c.createElement("button")),g()._html(a[e].name),a[e].focus&&g()._addClass("ui-MDialog-autofocus"),a[e].disabled&&g()._addClass("ui-MDialog-disabled"),"function"==typeof a[e].callback?(h=function(a){return function(){a.call(d)}}(a[e].callback),g()._bind("click",h)):a[e].disabled||g()._bind("click",function(){d._closeEvent(d.config.close)}),b._bottom()[0].appendChild(g()[0]),b._footer()._show()},_createIframe:function(a){var d,e,f=this,g=this.DOM;this.iframeId="MDialog_IFRAME_"+b.MDialog.zIndex,b.MDialog.iframeData[this.iframeId]=this,g._title()._text("Loading..."),g._body()._addClass("ui-MDialog-loading"),d='<p class="loading-text">Loading...</p><iframe src="'+a+'" name="'+this.iframeId+'" id="'+this.iframeId+'" allowtransparency="true" scrolling="auto" frameborder="0" width="100%" height="100%" style="display: none;"></iframe>',g._content()._html(d),d=g._content()[0].getElementsByTagName("iframe")[0],e=g._content()[0].getElementsByTagName("p")[0],e.style.display="block",this._sizzle(d)()._bind("load",function(){d.style.display="block",e.style.display="none",g._title()._text(f.config.title),g._body()._removeClass("ui-MDialog-loading");var a;try{a=c.getElementById(f.iframeId).contentWindow.document}catch(b){}a?(outWidth="auto"!=f.config.width?f.config.width:a.documentElement.scrollWidth+"px",outHeight="auto"!=f.config.height?f.config.height:a.documentElement.scrollHeight+"px",g._body()._css({width:"auto",height:"auto"}),g._content()._css({width:outWidth,height:outHeight})):(g._body()._css({width:"auto",height:"auto"}),g._content()._css({width:f.config.width,height:f.config.height})),f._position(f.config.top,f.config.left,!0),"function"==typeof f.config.oniframeload&&f.config.oniframeload.call(f,a)})},_position:function(a,d,e){var m,n,o,p,q,f=this.DOM,g=c.documentElement.clientWidth,h=c.documentElement.clientHeight,i=c.documentElement.scrollHeight,j=b.pageYOffset||c.documentElement.scrollTop||c.body.scrollTop,k=a.toString().indexOf("%"),l=d.toString().indexOf("%");return this.IE6?f._wrap()._css("position","absolute"):f._wrap()._css("position",this.config.fixed?"fixed":"absolute"),o=parseInt(f._wrap()._getCurrentStyle("width")),p=parseInt(f._wrap()._getCurrentStyle("height")),q=function(a,b,c){var d=b*(a/100)-c/2;return d>b-c?b-c:d},m=l>-1?q(parseInt(d),g,o)+"px":d,n=k>-1?q(parseInt(a),h,p)+"px":a,!this.config.fixed&&i>h&&(n=parseInt(n)+j+"px"),this.top=n,this.IE6&&this.config.fixed&&(n=parseInt(n)+j+"px"),f._wrap()._css({left:m,top:n}),e||f._wrap()._css("zIndex",b.MDialog.zIndex),this},_sizzle:function(a){var b=this;return function(){return b[0]=a,b}},_closeEvent:function(a){var e=this.DOM;return this.closeBoolean||(c.body.removeChild(e._wrap()[0]),this.config.lock&&c.body.removeChild(e._lock()[0]),"function"==typeof a&&a.call(this)),this.config.iframe&&delete d.iframeData[this.iframeId],this.closeBoolean=!0,delete d,this},_fixedEvent:function(){var b=this.DOM,d=a.pageYoffset||c.documentElement.scrollTop||c.body.scrollTop,e=parseFloat(this.top);return b._wrap()._css("top",d+e+"px"),this},_focusEvent:function(){var a=this.DOM;return b.MDialog.zIndex=b.MDialog.zIndex,a._wrap()._css("zIndex",b.MDialog.zIndex),this},_resize:function(){if(this.config.lock){var a=c.documentElement.clientHeight,b=c.documentElement.scrollHeight,d=a>b?a+"px":b+"px",e=this.DOM;e._lock()&&e._lock()._css("height",d)}return this._position(this.config.top,this.config.left,!0),this},_drag:function(){var b=this.DOM,d=this.config.fixed,e=this.IE6,f=this._sizzle(c),g=0,h=0,i=0,j=0,k=function(f){var q,r,f=f||a.event,k=f.clientX-i,l=f.clientY-j,m=c.documentElement.scrollHeight,n=c.documentElement.clientHeight,o=c.documentElement.clientWidth-g,p=d&&!e?n:n>m?n:m,p=p-h;q=0>k?0:k>=0&&o>=k?k:o,r=0>l?0:l>=0&&p>=l?l:p,b._wrap()._css({left:q+"px",top:r+"px"})},l=function(){f()._unbind("mousemove",k)},m=function(c){var c=c||a.event,d=parseFloat(b._wrap()._getCurrentStyle("top")),e=parseFloat(b._wrap()._getCurrentStyle("left"));i=c.clientX-e,j=c.clientY-d,g=parseInt(b._wrap()._getCurrentStyle("width")),h=parseInt(b._wrap()._getCurrentStyle("height")),f()._bind("mousemove",k),f()._bind("mouseup",l)};return b._header()._bind("mousedown",m),this},_getCurrentStyle:function(a){var b,d,e,g,f=this[0];return"defaultView"in c&&"getComputedStyle"in c.defaultView?b=c.defaultView.getComputedStyle(f,!1)[a]:"width"==a||"height"==a?(g=f.getBoundingClientRect(),d=g.right-g.left,e=g.bottom-g.top,b="width"==a?d:e):b=f.currentStyle[a],b},_css:function(a,b){var d=this[0],e=arguments[0];if("string"==typeof a)void 0!==typeof b&&("opacity"==a?this._opacity(b):d.style[a]=b);else for(i in e)"opacity"==i?this._opacity(e[i]):d.style[i]=e[i];return this},_padding:function(a){return"string"==typeof a?this._css("padding",a):this._css("padding",a+"px"),this},_size:function(a,b){var c,d=this.DOM;return c="string"==typeof b?b:b+"px",d._body()._css(a,c),this._position(this.config.top,this.config.left,!0),this},_opacity:function(a){var b=this[0],d="opacity"in c.documentElement.style;return void 0!==typeof a&&(d?b.style.opacity=a:b.style.filter="Alpha(opacity="+100*a+")"),this},_addClass:function(a){var b=this[0],c=b.className.replace(/^\s+|\s+$/g,"");return b.className=c+" "+a,this},_removeClass:function(a){var b=this[0],c=b.className.replace(a,"").replace(/^\s+|\s+$/g,"");return b.className=c,this},_show:function(){return this._css("display","block"),this},_hide:function(){return this._css("display","none"),this},_text:function(a){var b=this[0];return c.all?b.innerText=a:b.textContent=a,this},_html:function(a){var b=this[0];return b.innerHTML="",a.nodeType&&1==a.nodeType&&b.appendChild(a),(a.nodeType&&3==a.nodeType||"string"==typeof a)&&(b.innerHTML=a),this},_isArray:function(a){return"[object Array]"===Object.prototype.toString.call(a)},_bind:function(a,b){var c=this[0];return c.addEventListener?c.addEventListener(a,b,!1):c.attachEvent("on"+a,b),this},_unbind:function(a,b){var c=this[0];return c.removeEventListener?c.removeEventListener(a,b,!1):c.detachEvent("on"+a,b),this}},d.fn.init.prototype=d.fn,d.iframeData={},d.getIframe=function(a){return a?d.iframeData[a]:!1},d.templates='<div class="MDialog-wrapper"><table class="ui-MDialog-table"><tbody><tr><td><div class="ui-MDialog-header"><a class="ui-MDialog-close" href="javascript:void(0);">x</a><div class="ui-MDialog-title"></div></div></td></tr><tr><td><div class="ui-MDialog-body"><div class="ui-MDialog-content"></div></div></td></tr><tr><td><div class="ui-MDialog-footer"><div class="ui-MDialog-statusbar"></div><div class="ui-MDialog-bottom"></div><div style="clear:both;height:0;overflow:hidden;"></div></div></td></tr></tbody></table></div>',d.defaults={title:"消息",untitle:!1,content:"Loading....",statusbar:null,init:null,close:null,unclose:!1,width:"auto",height:"auto",padding:"20px 15px",lock:!1,background:"#000",opacity:.3,fixed:!1,esc:!0,time:null,left:"50%",top:"38.2%",zIndex:1992,id:null,ok:null,cancel:null,okVal:"确定",cancelVal:"取消",button:null,resize:!0,data:null,iframe:!1,oniframeload:null,drag:!0},"function"==typeof define&&define.amd&&define("MDialog",[],function(){return d}),b.MDialog=$M=d}(window);